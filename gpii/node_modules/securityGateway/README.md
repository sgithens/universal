

Internal configuration for our authentication providers is loosely as follows.

```javascript
{
    id: "oauth-github",
    desc: "Authentication provider using Github as an OAuth2 Provider",
    type: "oauth2",
    options: {
        // These are dependent on the 'type' value above, so the below are
        // specific to oauth2 using node-oauth.
        // https://github.com/ciaranj/node-oauth/blob/master/lib/oauth2.js#L8
        clientId: "This comes from your github account",
        clientSecret: "Github also provides this",
        baseSite: "https://github.com/",
        authorizePath: "login/oauth/authorize",
        accessTokenPath: "login/oauth/access_token",
        customHeaders: null
    }  
}
```

Internally, we store users with an internal GPII Unique Key (GUK). The GUK is the 
eternal non-changing key that is used to store a users preferences and 
any other information on a specific user, although there is very little
information we do store on users. Storage of contact or personal is left
to the outside identity management system that backs the configured auth
provider. However, we may request this information during authentication in 
order to construct a friendly user interface for that usage session.
Also, typically OAuth providers will return a long token used
to identify a user to our application. This token is typically different
from the users account name with that OAuth provider. We do not use this
token as their canonical identifier, so that it would be theoretically 
possible in the future to migrate their account to another authentication
provider configuration.

In addition to the GPII Unique Key and OAuth provider subkey, we store a 
list of tokens the user has registered that are used to trigger system
personalization. These can be added or removed, if for instance a user
loosed their RFID key or USB stick. These tokens allow only system 
personalization, and are not used for viewing or updating a users
entire set of needs and preferences. 

An entry for a single GPII user is as below:

```javascript
{
    guk: "E6AD35C4-EDB9-4CFA-8D5D-217530D2D160",
    authProvider: {
        id: "oauth-github",
        userSub: "17F7D0C043F84DBFAF3AB9369FE3A734"
    },
    loginTokens: [
        "0EC07E74-B66C-412F-976E-B2497EFE6BF8",
        "E4D24614-47F3-49F7-9266-C2DA6D906F8C"
    ]
}
```

The storage format of loginTokens may change over time to match 
performance requirements for fast lookup.
